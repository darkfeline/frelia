<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  {% macro make_link(link) -%}
  <link {{ link|tagattrs('href', 'rel', 'type') }} />
  {%- endmacro %}

  <id>{{ feed.id }}</id>
  <title>{{ feed.title }}</title>
  <updated>{{ feed.updated.isoformat() }}</updated>
  {% if feed.rights is not none %}
  <rights>{{ feed.rights }}</rights>
  {% endif %}
  {% for link in feed.links %}
  {{ make_link(link) }}
  {% endfor %}

  {% for author in feed.authors %}
  <author>
    <name>{{ author.name }}</name>
    {% if author.uri is not none %}
    <uri>{{ author.uri }}</uri>
    {% endif %}
    {% if author.email is not none %}
    <email>{{ author.email }}</email>
    {% endif %}
  </author>
  {% endfor %}

  {% for entry in feed.entries %}
  <entry>
    <id>{{ entry.id }}</id>
    <title>{{ entry.title }}</title>
    <updated>{{ entry.updated.isoformat() }}</updated>
    {% if entry.summary is not none %}
    <summary>{{ entry.summary }}</summary>
    {% endif %}
    {% if entry.published is not none %}
    <published>{{ entry.published }}</published>
    {% endif %}
    {% for link in entry.links %}
    {{ make_link(link) }}
    {% endfor %}
    {% for category in entry.categories %}
    <category {{ category|tagattrs('term', 'scheme', 'label') }} />
    {% endfor %}
  </entry>
  {% endfor %}
</feed>
